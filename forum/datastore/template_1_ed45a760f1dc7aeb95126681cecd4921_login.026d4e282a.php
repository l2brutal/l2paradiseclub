<?php

return <<<'VALUE'
"namespace IPS\\Theme;\nclass class_core_global_login extends \\IPS\\Theme\\Template\n{\n\tpublic $cache_key = '219a465162417b884b4278d1aeb82cb2';\n\tfunction authyAuthenticate( $method, $done, $error, $setup, $availableMethods, $onetouch=NULL, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elAuthy\" \nCONTENT;\n\nif ( $onetouch ):\n$return .= <<<CONTENT\ndata-controller=\"core.global.core.authyOneTouch\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t<div class=\"ipsPad ipsType_normal ipsType_center\">\n\t\t\nCONTENT;\n\nif ( $setup ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $method == 'authy' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_authy_setup', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelseif ( $method == 'phone' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_call_auth_done', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_sms_auth_done', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $method == 'authy' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $onetouch ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_onetouch_auth', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_authy_auth', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelseif ( $method == 'phone' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $done ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_call_auth_done', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_call_auth', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelseif ( $method == 'choose' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_choose_auth', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_sms_auth', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $method == 'authy' ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsType_center'>\n\t\t\t\t\nCONTENT;\n\nif ( $onetouch ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<input type=\"hidden\" name=\"onetouch\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $onetouch, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-role=\"onetouchCode\">\n\t\t\t\t\t<div class=\"ipsRedirect ipsPad ipsJS_show\">\n\t\t\t\t\t\t<div class=\"ipsLoading ipsRedirect_loading\"><\/div>\n\t\t\t\t\t\t<span>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_onetouch_waiting', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $setup ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$langCode = mb_substr( \\IPS\\Member::loggedIn()->language()->bcp47(), 0, 2 );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/authy_ios\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/ios\/{$langCode}.svg\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsSpacer_both\"><\/a>\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/authy_android\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/android\/{$langCode}.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" style=\"height: 60px\"><\/a>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $availableMethods ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( $setup ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<p class='ipsType_reset'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_setup_alternative', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/p>\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<ul class=\"ipsList_inline \nCONTENT;\n\nif ( !$setup ):\n$return .= <<<CONTENT\nipsSpacer_top\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'sms', $availableMethods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->csrf()->setQueryString( 'authy_method', 'sms' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_alt_sms', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nif ( in_array( 'phone', $availableMethods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->csrf()->setQueryString( 'authy_method', 'phone' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_alt_phone', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t\nCONTENT;\n\nif ( $done ):\n$return .= <<<CONTENT\n\n\t\t<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\">\n\t\t\t\nCONTENT;\n\nif ( !$onetouch ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li class=\"ipsFieldRow ipsClearfix \">\n\t\t\t\t\t<div class=\"ipsFieldRow_content cAuthy_container\">\n\t\t\t\t\t\t\nCONTENT;\n\nif ( $method == 'authy' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"login\/authy.png\", \"\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"cAuthy_icon\">\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<input type=\"text\" name=\"authy_auth_code\" value=\"\" class=\"\nCONTENT;\n\nif ( \\IPS\\Request::i()->authy_auth_code ):\n$return .= <<<CONTENT\nipsField_error\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $method == 'authy' ):\n$return .= <<<CONTENT\ncAuthy_field\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" autocomplete=\"off\" >\n\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->authy_auth_code or ( $method == 'authy' and \\IPS\\Request::i()->authy_method ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$val = \"{$error}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<li>\n\t\t\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium ipsSpacer_bottom \nCONTENT;\n\nif ( $onetouch ):\n$return .= <<<CONTENT\nipsJS_hide\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\nCONTENT;\n\nif ( $onetouch ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<i class='fa fa-check'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_submit_onetouch', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<i class='fa fa-lock'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_submit_code', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/button>\n\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nif ( $setup ):\n$return .= <<<CONTENT\n\n\t\t\t\t<li>\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->csrf()->setQueryString( '_new', '1' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_link ipsButton_medium ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_change_number', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/li>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/ul>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsPad ipsAreaBackground ipsGrid\">\n\t\t\t\nCONTENT;\n\nif ( in_array( 'phone', $availableMethods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsGrid_span\nCONTENT;\n\nif ( in_array( 'sms', $availableMethods ) ):\n$return .= <<<CONTENT\n6\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n12\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->csrf()->setQueryString( 'authy_method', 'phone' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t\t\t<i class='fa fa-phone'><\/i>&nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_submit_call', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( in_array( 'sms', $availableMethods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsGrid_span\nCONTENT;\n\nif ( in_array( 'phone', $availableMethods ) ):\n$return .= <<<CONTENT\n6\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n12\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->csrf()->setQueryString( 'authy_method', 'sms' ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" value=\"sms\" class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t\t\t<i class='fa fa-commenting'><\/i>&nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_submit_sms', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction authyError( $error ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elAuthy\">\n\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_error', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->isAdmin() ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsType_warning ipsSpacer_top\">\n\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $error, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\n\nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->canUseContactUs() ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsAreaBackground ipsPad\">\n\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", \"front\", \"contact\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_contact', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction authySetup( $countryCode, $phoneNumber, $showingMultipleForms, $methods, $error ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elAuthy\">\n\t<div class='ipsPad'>\n\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<div class=\"ipsType_medium ipsType_richText ipsType_center c2FA_info\">\n\t\t\t\nCONTENT;\n\nif ( in_array( 'authy', $methods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_authy_prefix', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_authy_only', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $methods ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nif ( count( $methods ) == 3 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_fallback_sms_or_phone', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelseif ( in_array( 'phone', $methods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_fallback_phone', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_fallback_sms', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_phone_prefix', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( count( $methods ) == 2 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_sms_or_phone', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelseif ( in_array( 'phone', $methods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_phone', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_mfa_desc_sms', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\t\nCONTENT;\n\nif ( in_array( 'authy', $methods ) ):\n$return .= <<<CONTENT\n\n\t\t<div class='ipsType_center'>\n\t\t\t\nCONTENT;\n\n$langCode = mb_substr( \\IPS\\Member::loggedIn()->language()->bcp47(), 0, 2 );\n$return .= <<<CONTENT\n\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/authy_ios\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/ios\/{$langCode}.svg\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsSpacer_both\"><\/a>\n\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/authy_android\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/android\/{$langCode}.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" style=\"height: 60px\"><\/a>\n\t\t<\/div>\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<div class=\"ipsPad\">\n\t\t<div class='ipsGrid'>\n\t\t\t<div class='ipsGrid_span3 ipsType_center'>\n\t\t\t\t<select data-control=\"diallingCode\" data-sort name=\"countryCode\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( \\IPS\\Helpers\\Form\\Tel::$diallingCodes as $country => $codes ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $codes as $code ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<option value=\"\nCONTENT;\n$return .= htmlspecialchars( $country, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n-\nCONTENT;\n$return .= htmlspecialchars( $code, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-code=\"+\nCONTENT;\n$return .= htmlspecialchars( $code, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" data-text=\"\nCONTENT;\n\n$val = \"country-{$country}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n (+\nCONTENT;\n$return .= htmlspecialchars( $code, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n)\" \nCONTENT;\n\nif ( $country == $countryCode or \"{$country}-{$code}\" == $countryCode ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$val = \"country-{$country}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n (+\nCONTENT;\n$return .= htmlspecialchars( $code, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n)<\/option>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/select>\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span9 ipsType_center'>\n\t\t\t\t<input name=\"phoneNumber\" type=\"tel\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $phoneNumber, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" placeholder=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_placeholder', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\">\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->countryCode ):\n$return .= <<<CONTENT\n\n\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$val = \"{$error}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class=\"ipsPad ipsAreaBackground ipsGrid\">\n\t\t\nCONTENT;\n\nif ( in_array( 'authy', $methods ) ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsGrid_span12\">\n\t\t\t\t<button type='submit' name=\"method\" value=\"authy\" class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t\t<i class='fa fa-lock'><\/i>&nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_submit_authy', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/button>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( in_array( 'phone', $methods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsGrid_span\nCONTENT;\n\nif ( in_array( 'sms', $methods ) ):\n$return .= <<<CONTENT\n6\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n12\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<button type='submit' name=\"method\" value=\"phone\" class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t\t\t<i class='fa fa-phone'><\/i>&nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_submit_call', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/button>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( in_array( 'sms', $methods ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsGrid_span\nCONTENT;\n\nif ( in_array( 'phone', $methods ) ):\n$return .= <<<CONTENT\n6\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n12\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\t<button type='submit' name=\"method\" value=\"sms\" class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t\t\t<i class='fa fa-commenting'><\/i>&nbsp; \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_submit_sms', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/button>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction authySetupLockout( $showingMultipleForms, $lockEndTime=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elAuthy\">\n\t<div class='ipsPad'>\n\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\nCONTENT;\n\n$sprintf = array($lockEndTime); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'authy_setup_lockout', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction googleAuthenticatorAuth( $waitUntil ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elGoogleAuthenticator\" data-controller=\"core.global.core.googleAuth\" data-waitUntil=\"\nCONTENT;\n$return .= htmlspecialchars( $waitUntil, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_auth', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\" data-role=\"codeInput\">\n\t\t<li class=\"ipsFieldRow ipsClearfix \" id=\"google_authenticator_form_google_authenticator_setup_code\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<input type=\"text\" name=\"google_authenticator_auth_code\" value=\"\" class=\"\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_auth_code ):\n$return .= <<<CONTENT\nipsField_error\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" autocomplete=\"off\" >\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_auth_code ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_invalid_code', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t<i class='fa fa-lock'><\/i> &nbsp;\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_submit_code', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/button>\n\t\t<\/li>\n\t<\/ul>\n\t<div class=\"ipsType_center ipsHide\" data-role=\"codeWaiting\">\n\t\t<div class=\"ipsProgressBar ipsProgressBar_animated\">\n\t\t\t<div class=\"ipsProgressBar_progress\" data-role=\"codeWaitingProgress\"><\/div>\n\t\t<\/div>\n\t\t<p class=\"ipsType_small\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_wait_for_code', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction googleAuthenticatorSetup( $qrCodeUrl, $secretKey, $showingMultipleForms ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id=\"elGoogleAuthenticator\" data-controller=\"core.global.core.googleAuth\">\n\t<input type=\"hidden\" name=\"secret\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $secretKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t<div data-role=\"barcode\">\n\t\t<div class='ipsPad'>\n\t\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsType_medium ipsType_richText ipsType_center c2FA_info\">\n\t\t\t\t\nCONTENT;\n\nif ( $showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_multi', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_single', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t<div class='ipsGrid_span4 ipsType_center'>\n\t\t\t\t<img src=\"\nCONTENT;\n$return .= htmlspecialchars( $qrCodeUrl, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" width=\"150\" height=\"150\">\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span8 ipsType_center'>\n\t\t\t\t\nCONTENT;\n\n$langCode = mb_substr( \\IPS\\Member::loggedIn()->language()->bcp47(), 0, 2 );\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_ios\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/ios\/{$langCode}.svg\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsSpacer_both\"><\/a>\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_android\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/android\/{$langCode}.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" style=\"height: 60px\"><\/a>\n\t\t\n\t\t\t\t<p class='ipsType_reset'>\n\t\t\t\t\t<a class=\"ipsCursor_pointer\" data-action=\"showManual\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_help', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\t<div data-role=\"manual\" class=\"ipsHide\">\n\t\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsType_medium ipsType_richText ipsType_center c2FA_info\">\n\t\t\t\t\nCONTENT;\n\nif ( $showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_multi_manual', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_desc_single_manual', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class='ipsGrid ipsGrid_collapsePhone'>\n\t\t\t<div class='ipsGrid_span5'>\n\t\t\t\t<ul class=\"ipsDataList ipsDataList_reducedSpacing\">\n\t\t\t\t\t<li class=\"\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_generic\">\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_account', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t\t<em>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_account_email', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/em>\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class=\"\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_generic\">\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_key', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t\t<code>\nCONTENT;\n$return .= htmlspecialchars( $secretKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/code>\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t\t<li class=\"\">\n\t\t\t\t\t\t<span class=\"ipsDataItem_generic\">\n\t\t\t\t\t\t\t<strong>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_timebased', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/strong><br>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'yes', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/span>\n\t\t\t\t\t<\/li>\n\t\t\t\t<\/ul>\n\t\t\t<\/div>\n\t\t\t<div class='ipsGrid_span7 ipsType_center'>\n\t\t\t\t\nCONTENT;\n\n$langCode = mb_substr( \\IPS\\Member::loggedIn()->language()->bcp47(), 0, 2 );\n$return .= <<<CONTENT\n\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_ios\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/ios\/{$langCode}.svg\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" class=\"ipsSpacer_both\"><\/a>\n\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= \\IPS\\Http\\Url::ips( \"docs\/googleauth_android\" );\n$return .= <<<CONTENT\n\" target=\"_blank\"><img src=\"\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->resource( \"appstores\/android\/{$langCode}.png\", \"core\", 'global', false );\n$return .= <<<CONTENT\n\" style=\"height: 60px\"><\/a>\n\t\t\n\t\t\t\t<p class='ipsType_reset ipsType_center'>\n\t\t\t\t\t<a class=\"ipsCursor_pointer\" data-action=\"showBarcode\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_help_reset', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/p>\n\t\t\t<\/div>\n\t\t<\/div>\n\t<\/div>\n\n\t<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\">\n\t\t<li class=\"ipsFieldRow ipsClearfix \" id=\"google_authenticator_form_google_authenticator_setup_code\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<input type=\"text\" name=\"google_authenticator_setup_code\" value=\"\" class=\"\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_setup_code ):\n$return .= <<<CONTENT\nipsField_error\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->google_authenticator_setup_code ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_mfa_invalid_code', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t<li>\n\t\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\t<i class='fa fa-lock'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'google_submit_code', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/button>\n\t\t<\/li>\n\t<\/ul>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction loginButton( $method ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\n<button type=\"submit\" name=\"_processLogin\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $method->id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class='ipsButton ipsButton_verySmall ipsButton_fullWidth ipsSocial \nCONTENT;\n$return .= htmlspecialchars( $method->buttonClass(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' style=\"background-color: \nCONTENT;\n$return .= htmlspecialchars( $method->buttonColor(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\nCONTENT;\n\nif ( $icon = $method->buttonIcon() ):\n$return .= <<<CONTENT\n\n\t\t<span class='ipsSocial_icon'>\n\t\t\t\nCONTENT;\n\nif ( is_string( $icon ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<i class='fa fa-\nCONTENT;\n$return .= htmlspecialchars( $method->buttonIcon(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'><\/i>\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t<img src=\"\nCONTENT;\n$return .= htmlspecialchars( $icon->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/span>\n\t\t<span class='ipsSocial_text'>\nCONTENT;\n\n$val = \"{$method->buttonText()}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$val = \"{$method->buttonText()}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/button>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaAuthenticate( $screen, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_top'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t<form action=\"\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" accept-charset='utf-8' data-ipsForm class=\"ipsForm ipsForm_fullWidth\">\n\t\t\t<input type=\"hidden\" name=\"mfa_auth\" value=\"1\">\n\t\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t{$screen}\n\t\t\t<div class=\"ipsAreaBackground ipsType_center ipsPad cOtherMethod\">\n\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( array( '_mfa' => 'alt', '_mfaMethod' => '' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link ipsButton_medium ipsButton_fullWidth'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_try_another_method', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n <i class='fa fa-angle-right'><\/i><\/a>\n\t\t\t<\/div>\n\t\t<\/form>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaLockout( $lockEndTime=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->mfa_lockout_behaviour == 'lock' ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\t\nCONTENT;\n\n$sprintf = array($lockEndTime); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_locked_out_end_time', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_locked_out', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\t\t\t\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->mfa_lockout_behaviour == 'email' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsAreaBackground ipsPad\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=mfarecovery\", \"front\", \"mfarecovery\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_email', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nelseif ( \\IPS\\Settings::i()->mfa_lockout_behaviour == 'contact' ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsAreaBackground ipsPad\">\n\t\t\t\t\t<a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", \"front\", \"contact\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_contact', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaRecovery( $handlers, $url, $knownDevicesAvailable=FALSE ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_top'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_recover_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t<p class='ipsType_medium ipsType_richText ipsType_center c2FA_info'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_recover_info', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/p>\n\t\t<div class=\"ipsPad\">\n\t\t\t<ul class=\"ipsList_reset\">\n\t\t\t\t\nCONTENT;\n\nforeach ( $handlers as $key => $handler ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsSpacer_bottom ipsSpacer_half\">\n\t\t\t\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( array( '_mfa' => 'alt', '_mfaMethod' => $key ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$val = \"{$handler->recoveryButton()}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $knownDevicesAvailable ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsSpacer_bottom ipsSpacer_half\"><a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( array( '_mfa' => 'knownDevice' ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_light ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_known_device', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( in_array( 'email', explode( ',', \\IPS\\Settings::i()->mfa_forgot_behaviour ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsSpacer_bottom ipsSpacer_half\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=settings&do=mfarecovery\", \"front\", \"mfarecovery\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_link ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_email', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( in_array( 'contact', explode( ',', \\IPS\\Settings::i()->mfa_forgot_behaviour ) ) and \\IPS\\Member::loggedIn()->canUseContactUs() ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class=\"ipsSpacer_bottom ipsSpacer_half\"><a href=\"\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=contact&controller=contact\", \"front\", \"contact\", array(), 0 ) );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_link ipsButton_fullWidth ipsButton_medium\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_recovery_contact', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a><\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/ul>\n\t\t<\/div>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction mfaSetup( $acceptableHandlers, $member, $url ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div id='elTwoFactorAuthentication' class='ipsModal' data-controller='core.global.core.2fa'>\n\t<div>\n\t\t<form action=\"\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\" accept-charset='utf-8' data-ipsForm class=\"ipsForm ipsForm_fullWidth\">\n\t\t\t<input type=\"hidden\" name=\"mfa_setup\" value=\"1\">\n\t\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\t\nCONTENT;\n\nif ( count( $acceptableHandlers ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class='ipsAreaBackground ipsType_center'>\n\t\t\t\t\t<div class='ipsPad'>\n\t\t\t\t\t\t<h1 class='ipsType_center ipsType_pageTitle'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\t\t\t\t<p class='ipsSpacer_top ipsSpacer_half ipsPos_center ipsType_medium ipsType_richText c2FA_info'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_setup_multiple', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/p>\n\t\t\t\t\t<\/div>\n\t\t\t\t\t<div class='ipsTabs ipsTabs_small ipsTabs_stretch ipsClearfix ipsJS_show' id='tabs_2fa' data-ipsTabBar data-ipsTabBar-contentArea='#ipsTabs_content_2fa'>\n\t\t\t\t\t\t<a href='#tabs_2fa' data-action='expandTabs'><i class='fa fa-caret-down'><\/i><\/a>\n\t\t\t\t\t\t<ul role='tablist'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$checked = NULL;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $acceptableHandlers as $key => $handler ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a href='#ipsTabs_tabs_2fa_2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' id='2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class=\"ipsTabs_item \nCONTENT;\n\nif ( !$checked ):\n$return .= <<<CONTENT\nipsTabs_activeItem\nCONTENT;\n\n$checked = $key;\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\" role=\"tab\">\n\t\t\t\t\t\t\t\t\t\t<input class='ipsJS_hide' type=\"radio\" name=\"mfa_method\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" id=\"el2FARadio_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( $checked == $key ):\n$return .= <<<CONTENT\nchecked\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$val = \"mfa_{$key}_title\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\t\t\t\t\t\t\n\t\t\t\t\t\t<\/ul>\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div id='ipsTabs_content_2fa' class='ipsTabs_panels'>\n\t\t\t\t\nCONTENT;\n\nforeach ( $acceptableHandlers as $key => $handler ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div id='ipsTabs_tabs_2fa_2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_panel' class=\"ipsTabs_panel\" aria-labelledby=\"2fa_tab_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" aria-hidden=\"false\">\n\t\t\t\t\t\t{$handler->configurationScreen( $member, ( count( $acceptableHandlers ) > 1 ), $url )}\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->mfa_required_groups != '*' and !$member->inGroup( explode( ',', \\IPS\\Settings::i()->mfa_required_groups ) ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsAreaBackground ipsType_center cOtherMethod ipsPad\">\n\t\t\t\t\t<a href='\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( '_mfa', 'optout' )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' class='ipsButton ipsButton_link ipsButton_fullWidth ipsButton_medium' data-confirm \nCONTENT;\n\nif ( \\IPS\\Member::loggedIn()->language()->checkKeyExists('security_questions_opt_out_warning_value') ):\n$return .= <<<CONTENT\ndata-confirmSubMessage=\"\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_opt_out_warning_value', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_opt_out', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/form>\n\t<\/div>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction oauthAuthorize( $url, $client, $scopes ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller=\"core.global.core.framebust\">\n\t<div class=\"ipsType_center ipsSpacer_bottom\">\n\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"global\", \"core\" )->userPhoto( \\IPS\\Member::loggedIn(), 'large' );\n$return .= <<<CONTENT\n\n\t\t<h1 class='ipsType_veryLarge ipsType_center'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Settings::i()->board_name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_authorize_title', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/h1>\n\t<\/div>\n\t<form action=\"\nCONTENT;\n$return .= htmlspecialchars( $url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" method=\"post\">\n\t\t<input type=\"hidden\" name=\"allow\" value=\"1\">\n\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t<div class=\"ipsBox ipsPad\">\n\t\t\t<div class=\"ipsType_large\">\n\t\t\t\t\nCONTENT;\n\nif ( $scopes and !$client->type ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\nCONTENT;\n\n$sprintf = array($client->_title); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_auth_scope_title_named', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<ul class=\"\nCONTENT;\n\nif ( $client->choose_scopes ):\n$return .= <<<CONTENT\nipsField_fieldList\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\nipsList_bullets\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsSpacer_top\">\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $scopes as $key => $scope ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $client->choose_scopes ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<span class='ipsCustomInput'>\n\t\t\t\t\t\t\t\t\t\t<input id=\"elScope_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" type=\"checkbox\" name=\"grantedScope[\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" checked>\n\t\t\t\t\t\t\t\t\t\t<span><\/span>\n\t\t\t\t\t\t\t\t\t<\/span>\n\t\t\t\t\t\t\t\t\t<div class=\"ipsField_fieldList_content\">\n\t\t\t\t\t\t\t\t\t\t<label for=\"elScope_\nCONTENT;\n$return .= htmlspecialchars( $key, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\nCONTENT;\n$return .= htmlspecialchars( $scope, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/label>\n\t\t\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $scope, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<\/li>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/ul>\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsType_center\">\nCONTENT;\n\n$sprintf = array($client->_title); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_auth_no_scope', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t<\/div>\n\t\t<div class=\"ipsAreaBackground ipsPad ipsType_center\">\n\t\t\t<a href=\"\nCONTENT;\n$return .= htmlspecialchars( $url->setQueryString( 'allow', 0 )->csrf(), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" class=\"ipsButton ipsButton_link\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'cancel', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<button type=\"submit\" class=\"ipsButton ipsButton_primary\">\nCONTENT;\n\n$sprintf = array(\\IPS\\Member::loggedIn()->name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_authorize_approve', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/button>\n\t\t<\/div>\n\t<\/form>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction oauthLogin( $url, $client, $scopes, $login, $error ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div data-controller=\"core.global.core.framebust\" class=\"ipsSpacer_top ipsSpacer_double\">\n\t<div class=\"ipsType_center ipsSpacer_bottom ipsPad\">\n\t\t<h1 class='ipsType_reset ipsType_veryLarge ipsType_center'>\nCONTENT;\n\n$sprintf = array(\\IPS\\Settings::i()->board_name); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'oauth_authorize_title', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'sprintf' => $sprintf ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() != 'disabled' ):\n$return .= <<<CONTENT\n\n\t\t\t<p class='ipsType_reset ipsType_large ipsType_center ipsType_light'>\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'dont_have_an_account', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'redirect' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->allow_reg_target, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target=\"_blank\">\n\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Http\\Url::internal( 'app=core&module=system&controller=register', 'front', 'register' )->setQueryString( 'ref', base64_encode( $url ) ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( \\IPS\\Login::registrationType() == 'normal' ):\n$return .= <<<CONTENT\ndata-ipsDialog data-ipsDialog-size='narrow' data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n'\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_up', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t<\/p>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/div>\n\t<form accept-charset='utf-8' method='post' action='\nCONTENT;\n$return .= htmlspecialchars( $login->url, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' data-controller=\"core.global.core.login\">\n\t\t<input type=\"hidden\" name=\"csrfKey\" value=\"\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Session::i()->csrfKey, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\t\t\nCONTENT;\n\n$usernamePasswordMethods = $login->usernamePasswordMethods();\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$buttonMethods = $login->buttonMethods();\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nif ( $usernamePasswordMethods and $buttonMethods ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $error ):\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"ipsMessage ipsMessage_error\">\nCONTENT;\n\n$val = \"{$error}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/div>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t<div class='ipsColumns ipsColumns_collapsePhone'>\n\t\t\t\t<div class='ipsColumn ipsColumn_fluid'>\n\t\t\t\t\t<div class='\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\nipsBox\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsPad'>\n\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"system\", \"core\" )->loginForm( $login );\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t\t<div class='ipsColumn ipsColumn_veryWide'>\n\t\t\t\t\t<div class='\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\nipsBox\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsPad'>\n\t\t\t\t\t\t<h2 class='ipsType_sectionHead'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_faster', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h2>\n\t\t\t\t\t\t\nCONTENT;\n\nif ( count( $buttonMethods ) > 1 ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<p class='ipsType_normal ipsType_reset ipsType_light'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'sign_in_with_these', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\nCONTENT;\n\nforeach ( $buttonMethods as $method ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t<div class='ipsPad_half ipsType_center'>\n\t\t\t\t\t\t\t\t{$method->button()}\n\t\t\t\t\t\t\t<\/div>\n\t\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t\t<\/div>\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nelseif ( $usernamePasswordMethods ):\n$return .= <<<CONTENT\n\n\t\t\t<div class='cLogin_single ipsPos_center'>\n\t\t\t\nCONTENT;\n\nif ( $error ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsMessage ipsMessage_error\">\nCONTENT;\n\n$val = \"{$error}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t<div class=\"\nCONTENT;\n\nif ( !\\IPS\\Request::i()->isAjax() ):\n$return .= <<<CONTENT\nipsBox\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n ipsPad\">\n\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Theme::i()->getTemplate( \"system\", \"core\" )->loginForm( $login );\n$return .= <<<CONTENT\n\n\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nelseif ( $buttonMethods ):\n$return .= <<<CONTENT\n\n\t\t\t<div class=\"cLogin_single ipsPos_center\">\n\t\t\t\t\nCONTENT;\n\nif ( $error ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<p class=\"ipsMessage ipsMessage_error\">\nCONTENT;\n\n$val = \"{$error}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nforeach ( $buttonMethods as $method ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<div class='ipsPad_half ipsType_center'>\n\t\t\t\t\t\t{$method->button()}\n\t\t\t\t\t<\/div>\n\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t<\/div>\n\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t<\/form>\n<\/div>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction oauthLoginStandard( $id, $action, $elements, $hiddenValues, $actionButtons, $uploadField, $class='', $attributes=array(), $sidebar, $form=NULL ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlspecialchars( $id, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n_submitted\" value=\"1\">\n\nCONTENT;\n\nforeach ( $hiddenValues as $k => $v ):\n$return .= <<<CONTENT\n\n\t<input type=\"hidden\" name=\"\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" value=\"\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\">\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<ul class='ipsList_reset'>\n\t\nCONTENT;\n\nforeach ( $elements as $collection ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nforeach ( $collection as $input ):\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nif ( $input instanceof \\IPS\\Helpers\\Form\\Password ):\n$return .= <<<CONTENT\n\n\t\t\t\t\nCONTENT;\n\nif ( $input instanceof \\IPS\\Helpers\\Form\\Password ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t<li class='ipsFieldRow ipsClearfix \nCONTENT;\n\nif ( $input->error ):\n$return .= <<<CONTENT\nipsFieldRow_error\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n' \nCONTENT;\n\nif ( $input->htmlId ):\n$return .= <<<CONTENT\nid=\"\nCONTENT;\n$return .= htmlspecialchars( $input->htmlId, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\t\t\t<label class='ipsFieldRow_label' for='\nCONTENT;\n$return .= htmlspecialchars( $input->htmlId, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n'>\n\t\t\t\t\t\t\t\nCONTENT;\n\n$val = \"{$input->name}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n \nCONTENT;\n\nif ( $input->required ):\n$return .= <<<CONTENT\n<span class='ipsFieldRow_required'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'required', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/label>\n\t\t\t\t\t\t<div class='ipsFieldRow_content'>\n\t\t\t\t\t\t\t{$input->html()}\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->allow_forgot_password != 'disabled' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( \\IPS\\Settings::i()->allow_forgot_password == 'redirect' ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Settings::i()->allow_forgot_password_target, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n' target=\"_blank\" class=\"ipsType_small\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t<a href='\nCONTENT;\n\n$return .= str_replace( '&', '&amp;', \\IPS\\Http\\Url::internal( \"app=core&module=system&controller=lostpass\", null, \"lostpassword\", array(), 0 ) );\n$return .= <<<CONTENT\n' data-ipsDialog data-ipsDialog-title='\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'forgotten_password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n' class=\"ipsType_small\">\n\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'forgotten_password', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $input->error ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<span class=\"ipsType_warning\">\nCONTENT;\n\n$val = \"{$input->error}\"; $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( $val, ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/span>\n\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<\/div>\n\t\t\t\t\t<\/li>\n\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t{$input->rowHtml($form)}\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction securityQuestionsAuth( $question ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n<div class=\"ipsPad ipsType_normal ipsType_richText ipsType_center\">\n\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_auth_blurb', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n<\/div>\n<ul class=\"ipsList_reset ipsPad ipsClearfix\">\n\t<li class=\"ipsFieldRow ipsClearfix\">\n\t\t<label class='ipsFieldRow_label'>\n\t\t\t\nCONTENT;\n$return .= htmlspecialchars( $question->_title, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t<\/label>\n\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t<input type=\"text\" name=\"security_answer\" autocomplete=\"off\" \nCONTENT;\n\nif ( \\IPS\\Request::i()->security_answer ):\n$return .= <<<CONTENT\nclass=\"ipsField_error\"\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\n\t\t\t\nCONTENT;\n\nif ( \\IPS\\Request::i()->security_answer ):\n$return .= <<<CONTENT\n\n\t\t\t\t<p class=\"ipsType_warning\">\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_answer_incorrect', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/p>\n\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/li>\n<\/ul>\n<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\">\n\t<li>\n\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t<i class='fa fa-lock'><\/i> \nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_answer_submit', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/button>\n\t<\/li>\n<\/ul>\n\nCONTENT;\n\n\t\treturn $return;\n}\n\n\tfunction securityQuestionsSetup( $securityQuestions, $showingMultipleForms ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( !$showingMultipleForms ):\n$return .= <<<CONTENT\n\n\t<div class='ipsPad'>\n\t\t<h1 class='ipsType_center ipsType_pageTitle ipsSpacer_bottom ipsSpacer_half'>\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'mfa_popup_setup_title', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n<\/h1>\n\t\t<div class=\"ipsType_normal ipsType_richText ipsType_center\">\n\t\t\t\nCONTENT;\n\n$pluralize = array( \\IPS\\Settings::i()->security_questions_number ?: 3 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_setup_blurb', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n\n\t\t<\/div>\n\t<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<ul class=\"ipsList_reset ipsPad ipsClearfix\">\n\t\nCONTENT;\n\nforeach ( range( 1, min( \\IPS\\Settings::i()->security_questions_number ?: 3, count( $securityQuestions ) ) ) as $i ):\n$return .= <<<CONTENT\n\n\t\t<li class=\"ipsFieldRow ipsClearfix\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<select name=\"security_question[\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\">\n\t\t\t\t\t\nCONTENT;\n\nforeach ( $securityQuestions as $k => $v ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t<option value=\"\nCONTENT;\n$return .= htmlspecialchars( $k, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\" \nCONTENT;\n\nif ( \\IPS\\Request::i()->security_question[$i] == $k ):\n$return .= <<<CONTENT\nselected\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n>\nCONTENT;\n$return .= htmlspecialchars( $v, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/option>\n\t\t\t\t\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n\t\t\t\t<\/select>\n\t\t\t<\/div>\n\t\t<\/li>\n\t\t<li class=\"ipsFieldRow ipsClearfix\">\n\t\t\t<div class=\"ipsFieldRow_content\">\n\t\t\t\t<input type=\"text\" name=\"security_answer[\nCONTENT;\n$return .= htmlspecialchars( $i, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n]\" value=\"\nCONTENT;\n\nif ( isset( \\IPS\\Request::i()->security_answer[$i] ) ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\Request::i()->security_answer[$i], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\">\n\t\t\t<\/div>\n\t\t<\/li>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n<\/ul>\n\nCONTENT;\n\nif ( is_array( \\IPS\\Request::i()->security_answer ) and count( array_filter( \\IPS\\Request::i()->security_answer ) ) ):\n$return .= <<<CONTENT\n\n\t<div class=\"ipsPad ipsType_warning\">\nCONTENT;\n\n$pluralize = array( \\IPS\\Settings::i()->security_questions_number ?: 3 ); $return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_unique', ENT_DISALLOWED, 'UTF-8', FALSE ), FALSE, array( 'pluralize' => $pluralize ) );\n$return .= <<<CONTENT\n<\/div>\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<ul class=\"ipsList_reset ipsPad ipsClearfix ipsAreaBackground\">\n\t<li>\n\t\t<button type='submit' class='ipsButton ipsButton_primary ipsButton_fullWidth ipsButton_medium'>\n\t\t\t\nCONTENT;\n\n$return .= \\IPS\\Member::loggedIn()->language()->addToStack( htmlspecialchars( 'security_questions_save', ENT_DISALLOWED, 'UTF-8', FALSE ), TRUE, array(  ) );\n$return .= <<<CONTENT\n\n\t\t<\/button>\n\t<\/li>\n<\/ul>\n\nCONTENT;\n\n\t\treturn $return;\n}}"
VALUE;
